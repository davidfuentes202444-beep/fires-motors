<div id="formCompra" class="hidden fixed inset-0 z-[100] flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/90 backdrop-blur-sm"></div>
    
    <div class="bg-white relative w-full max-w-xl rounded-[2.5rem] overflow-hidden shadow-2xl">
        <div class="bg-blue-900 p-5 text-white flex justify-between items-center">
            <div>
                <h2 class="text-xl font-black uppercase italic italic tracking-tighter">Registro de Compra</h2>
                <p id="montoTotal" class="text-green-400 font-black text-lg">Total: Bs. 0.00</p>
            </div>
            <button onclick="document.getElementById('formCompra').classList.add('hidden')" class="text-3xl">&times;</button>
        </div>
        
        <div class="p-6 overflow-y-auto max-h-[80vh] bg-slate-50">
            
            <div class="bg-white p-4 rounded-2xl border-2 border-blue-100 mb-6 shadow-sm">
                <h4 class="text-[10px] font-black uppercase text-blue-900 mb-2 text-center underline">Datos para Pago Móvil (Banesco)</h4>
                <div class="grid grid-cols-2 gap-2 text-xs font-bold text-slate-600">
                    <p>Banco: <span class="text-slate-900 italic">0134</span></p>
                    <p>Teléfono: <span class="text-slate-900 italic">04126324690</span></p>
                    <p class="col-span-2 text-center mt-1">Cédula: <span class="text-slate-900 italic">33.854.892</span></p>
                </div>
            </div>

            <div class="space-y-3">
                <p class="text-[10px] font-black text-slate-400 uppercase italic">Completa tus datos personales:</p>
                
                <input type="text" id="nombreC" class="w-full p-3 rounded-xl border-2 outline-none focus:border-blue-500 font-bold" placeholder="Nombre y Apellido">
                
                <div class="grid grid-cols-2 gap-2">
                    <input type="number" id="cedulaC" class="w-full p-3 rounded-xl border-2 outline-none focus:border-blue-500 font-bold" placeholder="Cédula">
                    <input type="number" id="tel1C" class="w-full p-3 rounded-xl border-2 outline-none focus:border-blue-500 font-bold" placeholder="Teléfono Principal">
                </div>

                <input type="number" id="tel2C" class="w-full p-3 rounded-xl border-2 outline-none focus:border-blue-500 font-bold" placeholder="Teléfono Secundario (Opcional)">
                
                <div class="bg-yellow-50 p-3 rounded-xl border-2 border-dashed border-yellow-400">
                    <p class="text-[10px] font-black text-yellow-600 uppercase mb-1">Referencia del Pago Móvil:</p>
                    <input type="text" id="refC" class="w-full p-3 rounded-lg border-2 outline-none focus:border-yellow-600 font-black uppercase" placeholder="Últimos 4 dígitos">
                </div>

                <button id="btnWhatsApp" class="w-full bg-green-600 text-white font-black py-5 rounded-2xl text-xl shadow-xl hover:bg-green-700 transition flex items-center justify-center">
                    <i class="fab fa-whatsapp mr-3 text-2xl"></i> CONFIRMAR PEDIDO
                </button>
                
                <p class="text-[9px] text-center text-slate-400 font-bold uppercase">Debe enviar el capture del comprobante al abrirse WhatsApp</p>
            </div>
        </div>
    </div>
</div>

<script>
// Función actualizada para enviar el mensaje con todos los datos
document.getElementById('btnWhatsApp').onclick = () => {
    const nom = document.getElementById('nombreC').value;
    const ced = document.getElementById('cedulaC').value;
    const t1  = document.getElementById('tel1C').value;
    const t2  = document.getElementById('tel2C').value || "No aplica";
    const ref = document.getElementById('refC').value;
    const monto = document.getElementById('montoTotal').innerText;

    if(!nom || !ced || !t1 || !ref || seleccionados.length === 0) {
        return alert("Por favor, llena todos los campos obligatorios y elige tus números.");
    }

    const mensaje = `*NUEVA RESERVA DE RIFA*%0A` +
                    `--------------------------%0A` +
                    `*Premio:* ${window.currentRifa.nombre}%0A` +
                    `*Números:* ${seleccionados.join(", ")}%0A` +
                    `*Total a Pagar:* ${monto}%0A` +
                    `--------------------------%0A` +
                    `*DATOS DEL CLIENTE:*%0A` +
                    `*Nombre:* ${nom}%0A` +
                    `*Cédula:* ${ced}%0A` +
                    `*Teléfono:* ${t1}%0A` +
                    `*Tel. Secundario:* ${t2}%0A` +
                    `*Ref. Pago:* ${ref}%0A` +
                    `--------------------------%0A` +
                    `_Adjunto el comprobante de pago._`;

    window.open(`https://wa.me/584126324690?text=${mensaje}`, '_blank');
};
</script>
